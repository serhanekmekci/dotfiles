#!/bin/sh

DARK_MODE_RGB="FFFFFF"
DARK_MODE_CONKY="#000000"

LIGHT_MODE_RGB="FFFFFF"
LIGHT_MODE_CONKY="#000000"

ALWAYS="
Xft.autohint: 0
Xft.antialias: 1
Xft.hinting: true
Xft.hintstyle: hintslight
Xft.dpi: 96
Xft.rgba: rgb
Xft.lcdfilter: lcddefault
/* DMENU */
dmenu.font:Fira Code:style=Regular:size=12:antialias=true:autohint=true

/* ST */
st.font:Fira Code:style=Regular:size=11:antialias=true:autohint=true
st.cwscale: 0.90
st.chscale: 1.05

tabbed.font:Fira Code:style=Regular:size=12:antialias=true

/* ! Dracula Xresources palette */
*.color0:     #000000
*.color1:     #FF5555
*.color2:     #50FA7B
*.color3:     #F1FA8C
*.color4:     #BD93F9
*.color5:     #FF79C6
*.color6:     #8BE9FD
*.color7:     #BFBFBF

*.color8:     #4D4D4D
*.color9:     #FF6E67
*.color10:    #5AF78E
*.color11:    #F4F99D
*.color12:    #CAA9FA
*.color13:    #FF92D0
*.color14:    #9AEDFE
*.color15:    #E6E6E6

*.foreground: #f8f8f2

dwm.topbar: 1
dwm.borderpx: 5
dwm.barborder: 5

dmenu.borderpx: 3

slock.init: #000000
slock.input: #000000
slock.failed: #FF6E67
slock.caps: #BD93F9
"

DARK_MODE="
/* DARK MODE */
dwm.normbgcolor: #000000
dwm.normbordercolor: #000000
dwm.normfgcolor: #ffffff

dwm.selfgcolor: #000000
dwm.selbordercolor: #ababab
dwm.selbgcolor: #ffffff

dwm.statfg: #ffffff
dwm.statbg: #000000

dwm.tagnormbg: #000000
dwm.tagnormfg: #ffffff

dwm.tagselbg: #ffffff
dwm.tagselfg: #000000

dwm.infonormbg: #000000
dwm.infonormfg: #ffffff

dwm.infoselbg: #ffffff
dwm.infoselfg: #000000

dwm.taggridbg: #ffffff
dwm.taggridfg: #000000
dwm.taggridborder: #ffffff

dmenu.background: #000000
dmenu.foreground: #ffffff
dmenu.selbackground: #ffffff
dmenu.selforeground:#000000

dmenu.highlightbackground: #000000
dmenu.higlightselbackground: #ffffff

dmenu.highlightforeground: #FF92D0
dmenu.highlightselforeground: #005577

dmenu.outbackground:#ffffff
dmenu.outforeground:#000000

tabbed.selbgcolor:#000000
tabbed.selfgcolor:#ffffff

tabbed.normbgcolor:#ababab
tabbed.normfgcolor:#ffffff

*.background: #000000

st.alpha: 1
"

LIGHT_MODE="
/* LIGHT MODE */
dwm.normbgcolor: #ffffff
dwm.normfgcolor: #000000
dwm.normbordercolor: #000000

dwm.selbgcolor: #000000
dwm.selfgcolor: #ffffff
dwm.selbordercolor: #ffffff

dwm.statfg: #000000
dwm.statbg: #ffffff

dwm.tagnormbg: #ffffff
dwm.tagnormfg: #000000

dwm.tagselbg: #ffffff
dwm.tagselfg: #000000

dwm.infonormbg: #ffffff
dwm.infonormfg: #000000

dwm.infoselbg: #000000
dwm.infoselfg: #ffffff

dwm.taggridbg: #000000
dwm.taggridfg: #ffffff
dwm.taggridborder: #000000

dmenu.background: #ffffff
dmenu.foreground: #000000
dmenu.selbackground: #000000
dmenu.selforeground:#ffffff

dmenu.highlightbackground: #ffffff
dmenu.higlightselbackground: #000000

dmenu.highlightforeground: #005577
dmenu.highlightselforeground:#FF92D0

dmenu.outbackground:#ffffff
dmenu.outforeground:#000000

tabbed.selbgcolor:#ffffff
tabbed.selfgcolor:#000000

tabbed.normbgcolor:#ababab
tabbed.normfgcolor:#ffffff

*.background: #282a36
st.alpha: 1
"

if [ -f $1 ]
then

	PROMPT="$(echo -e "Light\nDark" | dmenu -p "Change mode to:" -i -g 2 -l 2 -c)"

	if [ "$PROMPT" = "Light" ]
	then
		CHOOSED_CONFIG+="$ALWAYS $LIGHT_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st) &&
		kill -s USR1 $(pidof tabbed) &&

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme sol"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"sol"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc
		#sed -i "s/own_window_colour =.*/own_window_colour = '$LIGHT_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky.conf
		#sed -i "s/own_window_colour =.*/own_window_colour = '$LIGHT_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky2.conf
		openrgb -c $LIGHT_MODE_RGB
		rivalcfg -c $LIGHT_MODE_RGB --strip-bottom-color $LIGHT_MODE_RGB --strip-middle-color $LIGHT_MODE_RGB --strip-top-color $LIGHT_MODE_RGB

	elif [ "$PROMPT" = "Dark" ]
	then
		CHOOSED_CONFIG+="$ALWAYS $DARK_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st) &&
		kill -s USR1 $(pidof tabbed) &&

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme minimalist"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"minimalist"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc
		#sed -i "s/own_window_colour =.*/own_window_colour = '$DARK_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky.conf
		#sed -i "s/own_window_colour =.*/own_window_colour = '$DARK_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky2.conf
		openrgb -c $DARK_MODE_RGB
		rivalcfg -c $DARK_MODE_RGB --strip-bottom-color $DARK_MODE_RGB --strip-middle-color $DARK_MODE_RGB --strip-top-color $DARK_MODE_RGB

	fi

else

	if [ "$1" = "Light" -o "$1" = "light" ] ; then
		CHOOSED_CONFIG+="$ALWAYS $LIGHT_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st) &&
		kill -s USR1 $(pidof tabbed) &&

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme sol"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"sol"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc
		#sed -i "s/own_window_colour =.*/own_window_colour = '$LIGHT_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky.conf
		#sed -i "s/own_window_colour =.*/own_window_colour = '$LIGHT_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky2.conf
		openrgb -c $LIGHT_MODE_RGB
		rivalcfg -c $LIGHT_MODE_RGB --strip-bottom-color $LIGHT_MODE_RGB --strip-middle-color $LIGHT_MODE_RGB --strip-top-color $LIGHT_MODE_RGB

	elif [ "$1" = "Dark" -o "$1" = "dark" ] ; then
		CHOOSED_CONFIG+="$ALWAYS $DARK_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st) &&
		kill -s USR1 $(pidof tabbed) &&

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme minimalist"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"minimalist"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc
		#sed -i "s/own_window_colour =.*/own_window_colour = '$DARK_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky.conf
		#sed -i "s/own_window_colour =.*/own_window_colour = '$DARK_MODE_CONKY',/g" $XDG_CONFIG_HOME/conky/conky2.conf
		openrgb -c $DARK_MODE_RGB
		rivalcfg -c $DARK_MODE_RGB --strip-bottom-color $DARK_MODE_RGB --strip-middle-color $DARK_MODE_RGB --strip-top-color $DARK_MODE_RGB

	elif [ "$1" = "toggle" -o "$1" = "Toggle" ] ; then
		if grep -q "DARK MODE" $HOME/.config/X11/Xresources
		then
			change_mode light
		else
			change_mode dark
		fi
	fi
fi
